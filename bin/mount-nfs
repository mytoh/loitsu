#!/usr/bin/env mosh

(import (rnrs)
  (only (srfi :13 strings)
    string-join)
  (match)
  (mosh process))


(define (main args)
  (match (cadr args)
    ; commands
    ("mypassport"
     (mount-mypassport))
    ("deskstar"
     (mount-deskstar))
    ("quatre"
     (mount-quatre (caddr args)))
    ("all"
     (mount-mypassport)
     (mount-deskstar)
     (mount-quatre (caddr args)))
    ))

(define mount
  (lambda (src dest)
    (display (string-append "mounting " source))
    (newline)
    (call-process (string-join
                    `("sudo" "mount" "-v" ,src ,dest)))))

(define (mount-mypassport)
  (mount "quatrevingtdix:/Volumes/MyPassport"
         "/nfs/mypassport"))

(define (mount-deskstar)
  (mount "quatrevingtdix:/Volumes/Deskstar"
         "/nfs/deskstar"))

(define (mount-quatre user)
  (mount (string-append "quatrevingtdix:/Users/" user)
         "/nfs/quatre"))

(main (command-line))

;; vim:filetype=scheme
